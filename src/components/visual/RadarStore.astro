---
interface Props {
  class?: string;
}

const { class: className = '' } = Astro.props;
---

<div class:list={['radar-store', className]}>
  <div class="radar-container">
    <!-- SVG Radar Base -->
    <svg class="radar-svg" viewBox="0 0 400 400" fill="none" xmlns="http://www.w3.org/2000/svg">
      <!-- Concentric circles (grid) -->
      <circle cx="200" cy="200" r="180" stroke="rgba(0,229,255,0.1)" stroke-width="1" />
      <circle cx="200" cy="200" r="140" stroke="rgba(0,229,255,0.1)" stroke-width="1" />
      <circle cx="200" cy="200" r="100" stroke="rgba(0,229,255,0.15)" stroke-width="1" />
      <circle cx="200" cy="200" r="60" stroke="rgba(0,229,255,0.2)" stroke-width="1" />

      <!-- Cross lines -->
      <line x1="200" y1="20" x2="200" y2="380" stroke="rgba(0,229,255,0.08)" stroke-width="1" />
      <line x1="20" y1="200" x2="380" y2="200" stroke="rgba(0,229,255,0.08)" stroke-width="1" />
      <line x1="73" y1="73" x2="327" y2="327" stroke="rgba(0,229,255,0.05)" stroke-width="1" />
      <line x1="327" y1="73" x2="73" y2="327" stroke="rgba(0,229,255,0.05)" stroke-width="1" />

      <!-- Store Layout - Stylized shelves (rectangles) -->
      <g class="store-layout">
        <!-- Top-left shelf cluster -->
        <rect x="80" y="100" width="50" height="20" rx="2" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.1)" stroke-width="1" />
        <rect x="80" y="130" width="50" height="20" rx="2" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.1)" stroke-width="1" />
        <rect x="80" y="160" width="50" height="20" rx="2" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.1)" stroke-width="1" />

        <!-- Top-right shelf cluster -->
        <rect x="270" y="100" width="50" height="20" rx="2" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.1)" stroke-width="1" />
        <rect x="270" y="130" width="50" height="20" rx="2" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.1)" stroke-width="1" />
        <rect x="270" y="160" width="50" height="20" rx="2" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.1)" stroke-width="1" />

        <!-- Bottom-left shelf cluster -->
        <rect x="80" y="240" width="50" height="20" rx="2" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.1)" stroke-width="1" />
        <rect x="80" y="270" width="50" height="20" rx="2" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.1)" stroke-width="1" />

        <!-- Bottom-right shelf cluster -->
        <rect x="270" y="240" width="50" height="20" rx="2" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.1)" stroke-width="1" />
        <rect x="270" y="270" width="50" height="20" rx="2" fill="rgba(255,255,255,0.05)" stroke="rgba(255,255,255,0.1)" stroke-width="1" />

        <!-- Center checkout area -->
        <rect x="170" y="180" width="60" height="40" rx="4" fill="rgba(139,92,246,0.1)" stroke="rgba(139,92,246,0.3)" stroke-width="1" />

        <!-- Entrance (bottom center) -->
        <rect x="180" y="360" width="40" height="20" rx="2" fill="rgba(0,229,255,0.15)" stroke="rgba(0,229,255,0.3)" stroke-width="1" />
      </g>

      <!-- Center point -->
      <circle cx="200" cy="200" r="4" fill="#00e5ff" class="center-dot" />
    </svg>

    <!-- Sweeping beam -->
    <div class="radar-sweep">
      <svg viewBox="0 0 100 100" class="sweep-svg">
        <defs>
          <linearGradient id="sweepGradient" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="rgba(0,229,255,0)" />
            <stop offset="50%" stop-color="rgba(0,229,255,0.4)" />
            <stop offset="100%" stop-color="rgba(139,92,246,0.2)" />
          </linearGradient>
        </defs>
        <path d="M50,50 L50,0 A50,50 0 0,1 93.3,25 Z" fill="url(#sweepGradient)" />
      </svg>
    </div>

    <!-- Detection points with customers and products -->
    <div class="detection-points">
      <!-- Customer 1: Looking at shoes (top-left) -->
      <div class="detection-entity" style="top: 28%; left: 35%;">
        <div class="entity-icon customer-cyan">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <circle cx="12" cy="6" r="4"/>
            <path d="M12 12c-4 0-7 2-7 5v3h14v-3c0-3-3-5-7-5z"/>
          </svg>
        </div>
        <div class="entity-label">
          <span class="label-icon">ðŸ‘Ÿ</span>
          <span class="label-text">AyakkabÄ±</span>
        </div>
      </div>

      <!-- Customer 2: Looking at electronics (top-right) -->
      <div class="detection-entity" style="top: 32%; left: 68%;">
        <div class="entity-icon customer-purple">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <circle cx="12" cy="6" r="4"/>
            <path d="M12 12c-4 0-7 2-7 5v3h14v-3c0-3-3-5-7-5z"/>
          </svg>
        </div>
        <div class="entity-label">
          <span class="label-icon">ðŸ“±</span>
          <span class="label-text">Elektronik</span>
        </div>
      </div>

      <!-- Customer 3: Looking at groceries (bottom-left) -->
      <div class="detection-entity" style="top: 62%; left: 30%;">
        <div class="entity-icon customer-pink">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <circle cx="12" cy="6" r="4"/>
            <path d="M12 12c-4 0-7 2-7 5v3h14v-3c0-3-3-5-7-5z"/>
          </svg>
        </div>
        <div class="entity-label">
          <span class="label-icon">ðŸ›’</span>
          <span class="label-text">Market</span>
        </div>
      </div>

      <!-- Customer 4: Looking at clothes (bottom-right) -->
      <div class="detection-entity" style="top: 58%; left: 72%;">
        <div class="entity-icon customer-cyan">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <circle cx="12" cy="6" r="4"/>
            <path d="M12 12c-4 0-7 2-7 5v3h14v-3c0-3-3-5-7-5z"/>
          </svg>
        </div>
        <div class="entity-label">
          <span class="label-icon">ðŸ‘•</span>
          <span class="label-text">Giyim</span>
        </div>
      </div>

      <!-- Customer 5: At checkout (center) -->
      <div class="detection-entity" style="top: 48%; left: 52%;">
        <div class="entity-icon customer-purple">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <circle cx="12" cy="6" r="4"/>
            <path d="M12 12c-4 0-7 2-7 5v3h14v-3c0-3-3-5-7-5z"/>
          </svg>
        </div>
        <div class="entity-label">
          <span class="label-icon">ðŸ’³</span>
          <span class="label-text">Ã–deme</span>
        </div>
      </div>

      <!-- Product dots on shelves -->
      <div class="product-dot dot-cyan" style="top: 26%; left: 22%;" title="Spor AyakkabÄ±"></div>
      <div class="product-dot dot-pink" style="top: 27%; left: 24%;" title="Topuklu"></div>
      <div class="product-dot dot-purple" style="top: 34%; left: 72%;" title="Telefon"></div>
      <div class="product-dot dot-cyan" style="top: 35%; left: 75%;" title="KulaklÄ±k"></div>
      <div class="product-dot dot-pink" style="top: 60%; left: 22%;" title="Meyve"></div>
      <div class="product-dot dot-cyan" style="top: 65%; left: 24%;" title="Sebze"></div>
      <div class="product-dot dot-purple" style="top: 60%; left: 75%;" title="GÃ¶mlek"></div>
      <div class="product-dot dot-pink" style="top: 63%; left: 77%;" title="Pantolon"></div>
    </div>
  </div>
</div>

<style>
  .radar-store {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
  }

  .radar-container {
    position: relative;
    width: 100%;
    max-width: 700px;
    aspect-ratio: 1;
  }

  .radar-svg {
    width: 100%;
    height: 100%;
  }

  .store-layout {
    opacity: 0.8;
  }

  .center-dot {
    filter: drop-shadow(0 0 6px rgba(0, 229, 255, 0.8));
  }

  /* Radar sweep animation */
  .radar-sweep {
    position: absolute;
    inset: 0;
    animation: radar-sweep 5s linear infinite;
    transform-origin: center;
    will-change: transform;
  }

  .sweep-svg {
    width: 100%;
    height: 100%;
  }

  /* Detection points */
  .detection-points {
    position: absolute;
    inset: 0;
  }

  /* Customer entities with icons */
  .detection-entity {
    position: absolute;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    animation: entity-pulse 3s ease-in-out infinite;
  }

  .detection-entity:nth-child(2) { animation-delay: 0.6s; }
  .detection-entity:nth-child(3) { animation-delay: 1.2s; }
  .detection-entity:nth-child(4) { animation-delay: 1.8s; }
  .detection-entity:nth-child(5) { animation-delay: 2.4s; }

  .entity-icon {
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    animation: icon-glow 2s ease-in-out infinite;
  }

  .entity-icon svg {
    width: 12px;
    height: 12px;
  }

  .entity-icon.customer-cyan {
    background: rgba(0, 229, 255, 0.2);
    color: #00e5ff;
    box-shadow: 0 0 12px rgba(0, 229, 255, 0.5);
  }

  .entity-icon.customer-purple {
    background: rgba(139, 92, 246, 0.2);
    color: #8b5cf6;
    box-shadow: 0 0 12px rgba(139, 92, 246, 0.5);
  }

  .entity-icon.customer-pink {
    background: rgba(236, 72, 153, 0.2);
    color: #ec4899;
    box-shadow: 0 0 12px rgba(236, 72, 153, 0.5);
  }

  .entity-label {
    display: flex;
    align-items: center;
    gap: 4px;
    background: rgba(0, 0, 0, 0.7);
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 9px;
    white-space: nowrap;
    backdrop-filter: blur(4px);
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  .label-icon {
    font-size: 10px;
  }

  .label-text {
    color: rgba(255, 255, 255, 0.8);
    font-weight: 500;
  }

  /* Product dots */
  .product-dot {
    position: absolute;
    width: 6px;
    height: 6px;
    border-radius: 50%;
  }

  .product-dot.dot-cyan {
    background: #00e5ff;
    box-shadow: 0 0 8px rgba(0, 229, 255, 0.6);
  }

  .product-dot.dot-purple {
    background: #8b5cf6;
    box-shadow: 0 0 8px rgba(139, 92, 246, 0.6);
  }

  .product-dot.dot-pink {
    background: #ec4899;
    box-shadow: 0 0 8px rgba(236, 72, 153, 0.6);
  }

  .product-dot:nth-child(6) { animation-delay: 0.3s; }
  .product-dot:nth-child(7) { animation-delay: 0.6s; }
  .product-dot:nth-child(8) { animation-delay: 0.9s; }
  .product-dot:nth-child(9) { animation-delay: 1.2s; }
  .product-dot:nth-child(10) { animation-delay: 1.5s; }
  .product-dot:nth-child(11) { animation-delay: 1.8s; }
  .product-dot:nth-child(12) { animation-delay: 2.1s; }
  .product-dot:nth-child(13) { animation-delay: 2.4s; }

  @keyframes entity-pulse {
    0%, 100% { opacity: 0.7; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.05); }
  }

  @keyframes icon-glow {
    0%, 100% { filter: brightness(1); }
    50% { filter: brightness(1.3); }
  }

  @keyframes product-pulse {
    0%, 100% { opacity: 0.5; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.2); }
  }

  /* Sweep illumination effect - glow at START of animation cycle */
  @keyframes sweep-illuminate {
    0%, 8% {
      filter: brightness(1.6) drop-shadow(0 0 12px currentColor);
      transform: scale(1.3);
    }
    12%, 100% {
      filter: brightness(1) drop-shadow(0 0 0 transparent);
      transform: scale(1);
    }
  }

  @keyframes label-illuminate {
    0%, 8% {
      background: rgba(0, 229, 255, 0.25);
      border-color: rgba(0, 229, 255, 0.6);
    }
    12%, 100% {
      background: rgba(0, 0, 0, 0.7);
      border-color: rgba(255, 255, 255, 0.1);
    }
  }

  @keyframes product-illuminate {
    0%, 8% {
      opacity: 1;
      transform: scale(2);
      box-shadow: 0 0 12px currentColor;
    }
    12%, 100% {
      opacity: 0.5;
      transform: scale(1);
      box-shadow: 0 0 8px currentColor;
    }
  }

  /*
    Angles calculated clockwise from top (0Â°):
    Customer 1 (35%, 28%): ~326Â° â†’ delay 4.52s
    Customer 2 (68%, 32%): ~45Â° â†’ delay 0.62s
    Customer 3 (30%, 62%): ~239Â° â†’ delay 3.32s
    Customer 4 (72%, 58%): ~110Â° â†’ delay 1.53s
    Customer 5 (52%, 48%): ~45Â° â†’ delay 0.62s
  */

  /* Customer 1: ~326Â° â†’ delay 4.52s */
  .detection-entity:nth-child(1) .entity-icon {
    animation: sweep-illuminate 5s linear infinite;
    animation-delay: 4.52s;
  }
  .detection-entity:nth-child(1) .entity-label {
    animation: label-illuminate 5s linear infinite;
    animation-delay: 4.52s;
  }

  /* Customer 2: ~45Â° â†’ delay 0.62s */
  .detection-entity:nth-child(2) .entity-icon {
    animation: sweep-illuminate 5s linear infinite;
    animation-delay: 0.62s;
  }
  .detection-entity:nth-child(2) .entity-label {
    animation: label-illuminate 5s linear infinite;
    animation-delay: 0.62s;
  }

  /* Customer 3: ~239Â° â†’ delay 3.32s */
  .detection-entity:nth-child(3) .entity-icon {
    animation: sweep-illuminate 5s linear infinite;
    animation-delay: 3.32s;
  }
  .detection-entity:nth-child(3) .entity-label {
    animation: label-illuminate 5s linear infinite;
    animation-delay: 3.32s;
  }

  /* Customer 4: ~110Â° â†’ delay 1.53s */
  .detection-entity:nth-child(4) .entity-icon {
    animation: sweep-illuminate 5s linear infinite;
    animation-delay: 1.53s;
  }
  .detection-entity:nth-child(4) .entity-label {
    animation: label-illuminate 5s linear infinite;
    animation-delay: 1.53s;
  }

  /* Customer 5: ~45Â° â†’ delay 0.62s */
  .detection-entity:nth-child(5) .entity-icon {
    animation: sweep-illuminate 5s linear infinite;
    animation-delay: 0.62s;
  }
  .detection-entity:nth-child(5) .entity-label {
    animation: label-illuminate 5s linear infinite;
    animation-delay: 0.62s;
  }

  /* Product dots illumination - positioned near customers */
  .product-dot:nth-child(6) { animation: product-illuminate 5s linear infinite; animation-delay: 4.4s; }
  .product-dot:nth-child(7) { animation: product-illuminate 5s linear infinite; animation-delay: 4.6s; }
  .product-dot:nth-child(8) { animation: product-illuminate 5s linear infinite; animation-delay: 0.5s; }
  .product-dot:nth-child(9) { animation: product-illuminate 5s linear infinite; animation-delay: 0.7s; }
  .product-dot:nth-child(10) { animation: product-illuminate 5s linear infinite; animation-delay: 3.2s; }
  .product-dot:nth-child(11) { animation: product-illuminate 5s linear infinite; animation-delay: 3.4s; }
  .product-dot:nth-child(12) { animation: product-illuminate 5s linear infinite; animation-delay: 1.4s; }
  .product-dot:nth-child(13) { animation: product-illuminate 5s linear infinite; animation-delay: 1.6s; }

  /* Keyframes */
  @keyframes radar-sweep {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }


  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .radar-sweep,
    .detection-entity,
    .entity-icon,
    .entity-label,
    .product-dot {
      animation: none;
    }
  }

  /* Responsive */
  @media (max-width: 768px) {
    .radar-container {
      max-width: 280px;
    }

    .entity-icon {
      width: 16px;
      height: 16px;
    }

    .entity-icon svg {
      width: 10px;
      height: 10px;
    }

    .entity-label {
      padding: 2px 6px;
      font-size: 7px;
    }

    .label-icon {
      font-size: 8px;
    }

    .product-dot {
      width: 4px;
      height: 4px;
    }
  }

  @media (min-width: 769px) and (max-width: 1024px) {
    .radar-container {
      max-width: 500px;
    }
  }
</style>
